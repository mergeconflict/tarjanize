# Cleanup Ledger

Status legend: Not started, In progress, Done

| Crate | Comments | Structure | Error/Logging | Lint/Tests | Docs | Notes |
| --- | --- | --- | --- | --- | --- | --- |
| tarjanize-schemas | Done | Done | Done | Done | Done | Inventory: SymbolGraph/Package/Target/Module/Symbol, TargetTimings, Visibility/SymbolKind, CostModel/predict/load_cost_model. TODOs: remove Crate alias after Target-only usage; add proptest strategies for structurally valid graphs. Comments/cleanup complete; clippy/test pass. Checklist pass: walked `docs/cleanup-checklist.md` + smell lists; verified no production `#[expect]` or printf/debug logs; panics/expect only in tests. |
| tarjanize-schedule | Done | Done | Done | Done | Done | Inventory: core types ScheduleData/Summary/TargetData; scheduling in schedule.rs (compute_schedule, forward/backward pass, swim lanes); target graph + SCC condense in target_graph.rs; split/apply in split.rs; shatter + cost distribution in recommend.rs; export/heatmap helpers in export.rs/heatmap.rs. Cleanup: refactored shatter grouping/graph wiring, removed debug logs and production `#[expect]`, clippy/test pass. Checklist pass: walked `docs/cleanup-checklist.md` + smell lists; confirmed `#[expect]` only in cfg(test) (recommend.rs/heatmap.rs); added invariant comments around internal `expect`/split assumptions and defensive anchor selection. |
| cargo-tarjanize | Done | Done | Done | Done | Done | Inventory: CLI/main.rs with tracing init; orchestrator BuildConfig/run pipeline, crate mapping and symbol path transforms; driver callbacks and rustc invocation; extract HIR/THIR traversal via Extractor; profile rollups in ProfileData. Cleanup: comment pass across main/orchestrator/driver/extract/profile; removed production `#[expect]`; refactored driver run/extraction flow; added structured error handling for profiling/output; fixed doc markdown; clippy/test pass. Checklist pass: walked `docs/cleanup-checklist.md` + smell lists; verified no production `#[expect]` or debug prints; retained user-facing `eprintln!` for CLI errors only. |
| tarjanize-condense | Done | Done | Done | Done | Done | Inventory: SymbolIndex and SCC pipeline in scc.rs (`condense_and_partition`, `hmr_reduce`, `build_output_graph`, `compute_path_mapping`, `build_module_tree`, `rewrite_symbol`, `predict_wall_time`), anchors via `impl_anchors`; error type in error.rs; run() in lib.rs. Structure: overlap with tarjanize-schedule assessed (Task 21); extraction not justified â€” data structures differ fundamentally. `#[expect]` in scc.rs (clippy::too_many_lines) has reason. `expect` calls on indices/anchors have invariant comments. Debug logging is `tracing::debug!` (gated by level). TODOs for normalize_def_id fallback, anchor heuristic, downward merging, cost-model inflation are tracked as future work. clippy/29 tests clean. |
| tarjanize-viz | Done | Done | Done | Done | Done | Inventory: server.rs handlers (schedule/tree/shatter/export), AppState + TreeResponse, symbol cost breakdown; run_server in lib.rs; VizError in error.rs; static bundles from templates. TS: renderer.ts (PixiJS chart), logic.ts (pure fns), color.ts (HSL conversion), tooltip.ts, edges.ts, constants.ts, sidebar.ts, tree.ts. Structure: renderer split into 6 files (color/tooltip/edges/constants/logic/renderer); overlap with schedule assessed, extraction not justified. `#[expect]` on tree_handler has reason. `expect` on lock poisoning is idiomatic (poison = programming bug). `eprintln!` for server URL is user-facing output. All Rust + TS files have thorough what+why comments. ESLint/clippy/9 tests clean. |
| tarjanize-cost | Done | Done | Done | Done | Done | Inventory: TargetPredictors, FitResult (write_report/write_validation_table), CostOptions, ModelFit; fit/run/build_cost_model/model_fit pipeline; extract_predictors walks module tree; collect_frontend_cost/count_symbols_in_module helpers; format_duration_ms/truncate_name display. All functions/structs/fields have thorough what+why comments. One `#[expect]` (cast_possible_truncation) with reason. No stale logs. clippy/25 tests clean. |
| tarjanize-magsac | Done | Done | Done | Done | Done | Inventory: LinearModel/FitResult/MagsacParams/SigmaMax public API; fit_magsac/fit_magsac_with_params entry points; sigma_consensus_plus_plus IRLS loop; magsac_score/magsac_weight loss functions; solve_minimal/weighted_least_squares/ols_n_var/solve_normal_equations/solve_gaussian linear algebra; estimate_sigma_max_from_ols/required_iterations/is_degenerate_predictor/sample_k_distinct/enumerate_combinations/n_choose_k/expint_e1 utilities; XorShift64 RNG. All functions/structs/fields/constants have thorough what+why comments. `#[expect]` uses (too_many_lines, cast_*) all with reasons. No stale logs. clippy/11 tests clean. |
| tarjanize | Done | Done | Done | Done | Done | Inventory: Cli/IoArgs/Commands structs; main() dispatches condense/cost/viz subcommands; IoArgs::run handles file/stdio I/O; structured logging with crate allowlist. All structs/enums/methods/code blocks have what+why comments. One user-facing `eprintln!` for cost model warning (appropriate). No `#[expect]` in production. clippy clean; no unit tests (binary crate). |
