<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>tarjanize â€” interactive split explorer</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <!-- Main panel: sidebar + Gantt viewport. -->
  <div id="right-panel">
    <!-- Sidebar: summary stats, search, target details, and legend.
         Populated by renderer.ts at startup using DATA.summary values. -->
    <div id="sidebar">
      <h2>tarjanize</h2>
      <div class="stat">Critical path: <span class="stat-value" id="stat-cp"></span></div>
      <div class="stat">Total cost: <span class="stat-value" id="stat-total"></span></div>
      <div class="stat">Parallelism: <span class="stat-value" id="stat-parallel"></span></div>
      <div class="stat">Targets: <span class="stat-value" id="stat-targets"></span></div>
      <div class="stat">Symbols: <span class="stat-value" id="stat-symbols"></span></div>
      <div class="stat">Peak lanes: <span class="stat-value" id="stat-lanes"></span></div>
      <input type="text" id="search-input" placeholder="Search targets...">
      <div id="recommendations" style="display:none">
        <div id="rec-header"></div>
        <button id="shatter-btn">Shatter by horizon</button>
        <div id="rec-list"></div>
      </div>
      <div class="legend">
        <div style="font-size: 12px; margin-bottom: 4px;">Slack <span class="help-icon" data-tip="Slack is how much a target could be delayed without extending the overall build. Zero slack (red) means the target is on the critical path &mdash; any delay would increase total build time. High slack (blue) means the target has room to spare and is not a bottleneck.">?</span></div>
        <div class="legend-gradient"></div>
        <div class="legend-labels"><span>0 (critical)</span><span>max</span></div>
      </div>
      <button id="save-btn">Save Symbol Graph</button>
    </div>

    <!-- Draggable resize handle between sidebar and viewport. -->
    <div id="sidebar-resize"></div>

    <!-- PixiJS canvas mounts inside this div. -->
    <div id="viewport"></div>
  </div>

  <!-- Floating tooltip for hover details. Hidden by default. -->
  <div id="tooltip"></div>

  <!-- Import map: resolve bare specifiers to CDN ESM bundles.
       pixi.js v8 for the Gantt chart. -->
  <script type="importmap">
  {
    "imports": {
      "pixi.js": "https://cdn.jsdelivr.net/npm/pixi.js@8/dist/pixi.min.mjs"
    }
  }
  </script>

  <!-- Fetch schedule data, set window.DATA, then dynamically import the
       renderer bundle. Top-level await ensures DATA is populated before
       the renderer reads it at module load time. -->
  <script type="module">
    const resp = await fetch('/api/schedule');
    window.DATA = await resp.json();
    await import('/static/bundle.js');
  </script>

  <!-- Sidebar event wiring (IIFE). Runs after the module script above
       completes, by which time window.DATA and window.updateSchedule
       are set by the renderer bundle. -->
  <script src="/static/sidebar.js"></script>
</body>
</html>
